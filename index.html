<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<link rel="icon" type="image/svg+xml" href="/vite.svg" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>HAPPY BDAY SAM</title>
		<link rel="stylesheet" href="./src/index.css" />
		<script type="module" src="/src/slideshow.ts"></script>
	</head>
	<body>
		<main id="startbtn"><h1>START</h1></main>
		<main id="lezgo" style="display: none">
			<h1>HAPPY 18TH BIRTHDAY SAM</h1>
			<photo-slideshow></photo-slideshow>
			<h1>THANKS FOR BEING OUR FRIEND!</h1>
			<img class="amongus" src="/gif/among-us-twerk.gif" width="400" height="300" />
			<img class="anime-girl" src="/gif/anime girl dance.gif" width="400" height="300" />
			<!-- <img class="man" src="/gif/man-twirk.gif" width="400" height="300" /> -->
		</main>
		<div id="loader" style="display: none;">
			<p>Loading ...</p>
		</div>
		<script>
			audio1 = new Audio('/audio/csr.mp3'); 
			audio2 = new Audio('/audio/happybday.mp3'); 
		
			// Add event listeners to handle audio playback completion
			audio1.addEventListener('ended', () => playRandomAudio());
			audio2.addEventListener('ended', () => playRandomAudio());

			function playRandomAudio() {
			return new Promise((resolve, reject) => {
				// const randomAudio = Math.random() > 0.5 ? this.audio1 : this.audio2;
				const randomAudio = this.audio2;

				// Check if the audio is loaded and can be played
				if (!randomAudio) {
					reject("Audio not available");
					return;
				}

				randomAudio.play();

				randomAudio.onended = () => {
					resolve(); // Resolve the promise when the audio finishes playing
				};

				randomAudio.onerror = (err) => {
					reject(err); // Reject the promise if there's an error
				};
			});
		}

			let startbtn = document.getElementById("startbtn");
			let content = document.getElementById("lezgo");
			const loader = document.getElementById("loader");

			startbtn.addEventListener("click", () => {
				console.log("clicked");
				//Show the loader and hide the button
				loader.style.display = "";
				startbtn.style.display = "none";
				playRandomAudio();
				content.style.display = "";
				loader.style.display = "none";
				// TODO: fix the loading decoding issue
				// playRandomAudio().then(() => {
				// 	//Hide the loader and show the content
				// });
			});
		</script>
	</body>
</html>

